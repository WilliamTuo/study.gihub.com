<html>
<head>
  <title>通用首部字段</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600240 (zh-CN, DDL); Windows/6.1.1 (Win32);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="797"/>
<h1>通用首部字段</h1>

<div>
<span><div><ol><li><div>Cache-Control</div></li></ol><div><span>    </span><span>    </span><span>    通过指定首部字段 Cache-Control 的指令， 就能操作缓存的工作机制</span><br/></div><div><span><span><span>    </span><span>    </span><span>    可用于请求及响应时。</span>    </span><span>    </span><span>    </span><br/></span></div><div><span><br/></span></div><div><span>    </span><span>    </span><span>    public/private（属于 Cache- Control 缓存响应指令, 可向任意方提供响应的缓存）</span><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span>    </span><span>    </span><span>    Cache-Control: public （private）</span></div></div><div><span>    </span><span>    </span><span>    </span><span>    当指定为 public 指令时， 则明确指明其他用户也可利用缓存</span><br/></div><div><span><span>    </span><span>    </span><span>    <span>    当指定为 private 指令时， 响应只以特定的用户作为对象，缓存服务器只对特定用户提供资源缓存的服务，对于其他用户发送过来的请求，代理服务器则不会返回缓存。</span></span><br/></span></div><div><span><br/></span></div><div><span><span>    </span><span>    </span><span>    no-cache（不能缓存过期的资源） ： 使用该指令的目的是为了防止从缓存中返回过期的资源。</span><br/></span></div><div><span><br/></span></div><div><span><span>    </span><span>    </span><span>    no-store ： 暗示请求（和对应的响应） 或 响应中包含机密信息。 该指令规定缓存不能在本地存储请求或者响应的任一部分。</span><br/></span></div><div><span><br/></span></div><div><span>    </span><span>    </span>指定缓存期限和认证的指令</div><div><span>    </span><span>    </span><span>    s-maxage 指令： 适用于多用户使用的公共缓存服务器。使用 s-maxage 指令后， 则直接忽略对 Expires 首部字段及 max-age 指令的处理。</span><br/></div><div><span><span>    </span><span>    </span><span>    </span><br/></span></div><div><span><span>    </span><span>    </span><span>    max-age 指令： 如果判定缓存资源缓存时间数值比指定时间的数值小， 客户端就接收缓存的资源。如果 max-age 为0， 那么缓存服务器通常需要将请求转发给源服务器。</span><br/></span></div><div><span><br/></span></div><div><span><span>    </span><span>    </span><span>    附注： HTTP/1.1 如果遇到 同时存在 Expires 首部字段的情况时， 优先处理 max-age 指令， 而 HTTP/1.0 刚好相反。</span><br/></span></div><div><span><br/></span></div><div><span><span>    </span><span>    </span><span>    min-fresh 指令： 要求缓存服务器返回至少还未过指定时间的缓存资源。</span><br/></span></div><div><span><span>    </span><span>    </span><span>    </span><br/></span></div><div><span><span>    </span><span>    </span><span>    max-stale ： 可指示缓存资源，即使过期也照常接收。</span><br/></span></div><div><span><span>    </span><span>    </span><span>    </span><br/></span></div><div><span><span>    </span><span>    </span><span>    only-if-cached : 表示客户端仅在服务器本地缓存目标资源的情况下才会要求其返回。</span><br/></span></div><div><span><br/></span></div><div><span><span>    </span><span>    </span><span>    must-revalidate : 代理会向源服务器再次验证即将返回的响应缓存目前是否仍然有效。使用该指令会 忽略请求的 max-stale 指令。</span><br/></span></div><div><span><br/></span></div><div><span>    </span><span>    </span><span>    proxy-revalidate<span> </span>: 要求所有的缓存服务器在接收到客户端带有该指令的请求返回响应之前，必须再次验证缓存的</span>有效性</div><div><br/></div><div><span>    </span><span>    </span><span>    no-transform ： 无论是在请求还是响应中， 缓存都不能改变实体主体的媒体类型。可防止缓存或代理压缩图片等类似操作。</span><br/></div><div><span><br/></span></div><div><span><span>    Cache-Control 扩展：</span><br/></span></div><div><span><span>    </span><span>    </span><span>    </span><span>    cache-extension token</span><br/></span></div><div><span><span>    </span><span>    </span><span>    通过 cache-extension 标记（token）, 可以扩展 Cache-Control 首部字段内的指令。</span><br/></span></div><div><span><br/></span></div><ol start="2"><li><div><span>Connection</span></div></li></ol><div><span>    </span><span>    </span><span>    </span><span>    作用： 1.控制不再转发给代理的首部字段； Connection : 不在转发的首部字段名</span></div><div><span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>  </span> 2. 管理持久连接<span>    </span><span>    </span><span>    </span><span>    Connection: close (Keep-Alive)</span></span><br/></div><div><span><br/></span></div><div><span><span>    </span><span>    HTTP/1.1 版本的默认连接都是持久连接， 在该版本之前默认连接都是非持久连接， 在旧版本中，如果维持持久连接，需要指定 Connection 首部字段的值 Keep-Alive。</span><br/></span></div><div><span><br/></span></div><div><br/></div><div><span>    </span><span>   3. Date 表明创建 HTTP 报文的日期和时间</span></div><div><span><br/></span></div><div><span>    </span><span>   4. Pragma </span></div><div><span><span>    </span><span>    </span><span>    </span><span>    Pragam  是 HTTP/1.1 之前的版本遗留字段， 仅作为与 HTTP/1.0<span>   版本向后兼容而定义</span></span><br/></span></div><div><span><span>    </span><span>    </span><span>    </span><span>    规范定义的形式唯一： </span><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span><span>    </span><span>    Pragma : no-cache</span><br/></span></div></div><div><span><span><span>    </span><span>    </span><span>    </span><span>    该首部字段属于通用首部字段， 但只用于客户端发送的请求中。客户端会要求所有的中间服务器不返回缓存的资源。</span> </span> </span><br/></div><div><span>    </span><span>    </span><span>    </span><span>    </span><br/></div><div><span>    </span><span>    </span><span>    </span><span>    如果都能以 HTTP/1.1 为基准，那直接采用 Cache-Control : no cache 指定缓存处理方式， 但是因为不能掌握中间服务器使用的 HTTP 协议版本，所以</span>发送请求会同时含有下面两个首部字段</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span>    </span><span>    Cache-Control: no-cache</span></div><div><span>    </span><span>    Pragma : no-cache</span><span><br/></span></div></div><div><br/></div><ol start="5"><li><div>Trailer </div></li></ol><div><span>    </span><span>    </span><span>    事先说明在报文主体后记录了哪些首部字段。 该首部字段可应用在 HTTP/1.1 版本 分块传输编码时。</span><br/></div><div><span><br/></span></div><div><span><span>    </span><span>    6. Transfer-Encoding</span><br/></span></div><div><span><span>    </span><span>    </span><span>    规定了传输报文主体时采用的编码方式。</span><br/></span></div><div><span><br/></span></div><div><span><span>    </span><span>    7. Upgrade</span><br/></span></div><div><span><span>    </span><span>    </span><span>    用于检测 HTTP 协议及其他协议是否可使用更高版本进行通信，其参数值可用来指定一个完全不同的通信协议</span><br/></span></div><div><span><br/></span></div><div><span><span>    </span><span>    8.Via</span><br/></span></div><div><span><span>    </span><span>    </span><span>    使用首部字段 Via 是为了追踪客户端与服务器之间的请求和响应报文的传输路径。</span><br/></span></div><div><span><span>    </span><span>    </span><span>    不仅用于追踪报文的转发， 还可避免请求回环的发生。所以必须在经过代理时附加该首部字段内容。</span><br/></span></div><div><span><span>    </span><span>    </span><span>    经常会和 TRACE 方法一起使用</span><br/></span></div><div><span><br/></span></div><div><span><span>    </span><span>    9.Warning</span><br/></span></div><div><span><span>    </span><span>    </span><span>    该首部会通知用户一些与缓存有关的问题的警告。</span><br/></span></div><div><span><span>    </span><span>    </span><br/></span></div><div><br/></div><div><br/></div><div><br/></div></div></span>
</div></body></html> 